/**
 * Module dependencies.
 */function sha1(e){return crypto.createHash("sha1").update(e).digest("hex")}var crypto=require("crypto");exports.sign=function(e,t){if("string"!=typeof e)throw new TypeError("Cookie value must be provided as a string.");if("string"!=typeof t)throw new TypeError("Secret string must be provided.");return e+"."+crypto.createHmac("sha256",t).update(e).digest("base64").replace(/\=+$/,"")};exports.unsign=function(e,t){if("string"!=typeof e)throw new TypeError("Signed cookie string must be provided.");if("string"!=typeof t)throw new TypeError("Secret string must be provided.");var n=e.slice(0,e.lastIndexOf(".")),r=exports.sign(n,t);return sha1(r)==sha1(e)?n:!1};